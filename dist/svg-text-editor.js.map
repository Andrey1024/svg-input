{"version":3,"sources":["webpack:///webpack/bootstrap 445af2b2af91f226d3ad","webpack:///./app/textEditor.js","webpack:///./app/index.js"],"names":["svgNS","inputElement","nowEdit","setAttributes","obj","prop","setAttribute","TextEditor","parent","string","options","__lineHeight","__options","x","y","width","height","__value","__root","__tspanClass","__appendInputElement","__appendTextElement","__render","event","__promise","$","Deferred","endEdit","show","value","focus","bind","__keyup","e","__textElement","__mouseDown","__mouseClick","__mouseDblclick","__init","index","__getIndexFromPos","pageX","pageY","length","__setCursor","promise","unbind","__deleteCursor","__deleteSelBlock","resolve","document","body","contains","appendChild","hide","getNumberOfChars","__stringsNum","res","sum","__stringsData","line","cur","words","split","start","end","shift","isCenterAligned","isVerticalCenterAligned","getEndPositionOfChar","__getLineOfChar","__textbb","getStartPositionOfChar","left","right","dstr","tx","ty","bx","by","select","createElementNS","call","style","from","to","curLine","endLine","fromChar","toChar","fromBBox","__getCharBBox","l","__lactCharIndex","toBBox","r","__appendSelblock","__firstCharIndex","selectionStart","selectionEnd","__cursor","__appendCursorElement","charData","display","__blink","setInterval","mouseX","mouseY","transform","getScreenCTM","inverse","result","ownerSVGElement","createSVGPoint","a","c","b","d","f","usrPos","__screenToUser","getCharNumAtPosition","isInEditMode","getBBox","tspans","childNodes","lenght","i","tspan","__setTextContent","getComputedTextLength","empty","stringsNum","test","localstr","__testWidth","word","unshift","join","__rendering","mod","setTimeout","__renderTimeout","__setSelection","remove","input","createElement","type","css","position","top","back","__lastSelectEnd","__lastSelectStart","selectionDirection","clearInterval","el","str","append","stopPropagation","keyCode","ctrlKey","preventDefault","detail","selectWord","__getWordBounds","__setInputSelection","Math","min","max","__selecting","one","__mouseUp","__mouseMove","HTMLInputElement","ready","edit","startEdit","then","ret","alert"],"mappings":"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","file":"svg-text-editor.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"dist\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 445af2b2af91f226d3ad","const svgNS = 'http://www.w3.org/2000/svg';\r\nlet inputElement;\r\nlet nowEdit;\r\n\r\nfunction setAttributes(obj) {\r\n    for (let prop in obj) {\r\n        this.setAttribute(prop, obj[prop]);\r\n    }\r\n}\r\n\r\nexport default class TextEditor {\r\n    constructor(parent, string, options) {\r\n        this.__lineHeight = 15;\r\n\r\n        this.__options = {\r\n            x: options.x || 0,\r\n            y: options.y || 0,\r\n            width: options.width || 100,\r\n            height: options.height || 100\r\n        }\r\n        this.__value = string || '';\r\n        this.__root = parent;\r\n\r\n        this.__tspanClass = '';\r\n\r\n        this.__appendInputElement();\r\n        this.__appendTextElement();\r\n        this.__render();\r\n    }\r\n\r\n    startEdit(event) {\r\n        this.__promise = $.Deferred();\r\n        if (nowEdit && nowEdit != this) nowEdit.endEdit();\r\n        nowEdit = this;\r\n        this.show();\r\n\r\n        inputElement.value = this.__value;\r\n        inputElement.focus();\r\n        $(inputElement).bind('keyup input', e => this.__keyup(e));\r\n        $(inputElement).bind('blur', () => this.endEdit());\r\n        $(this.__textElement).bind('mousedown', e => this.__mouseDown(e));\r\n        $(this.__textElement).bind('click', e => this.__mouseClick(e));\r\n        $(this.__textElement).bind('dblclick', e => this.__mouseDblclick(e));\r\n\r\n        this.__init();\r\n        let index = event ? this.__getIndexFromPos(event.pageX, event.pageY) : this.__value.length;\r\n        this.__setCursor(index);\r\n        return this.__promise.promise();\r\n    }\r\n\r\n    endEdit() {\r\n        if (!this.__promise) return;\r\n\r\n        nowEdit = false;\r\n        $(inputElement).unbind('keyup input');\r\n        $(inputElement).unbind('blur');\r\n        $(this.__textElement).unbind('mousedown');\r\n        $(this.__textElement).unbind('mousemove');\r\n        $(this.__textElement).unbind('dblclick');\r\n        $(this.__textElement).unbind('click');\r\n        this.__deleteCursor();\r\n        this.__deleteSelBlock();\r\n        this.__promise.resolve(inputElement.value);\r\n        this.__promise = false;\r\n    }\r\n\r\n    update(parent, string, options) {\r\n        this.endEdit();\r\n        this.__options = options;\r\n        this.__value = string;\r\n        this.__root = parent;\r\n        if (!document.body.contains(this.__textElement)) parent.appendChild(this.__textElement);\r\n        this.__render();\r\n    }\r\n\r\n    hide() {\r\n        this.endEdit();\r\n        $(this.__textElement).hide();\r\n    }\r\n\r\n    show() {\r\n        $(this.__textElement).show();\r\n    }\r\n\r\n    isInEditMode() {\r\n        return !!this.__promise;\r\n    }\r\n\r\n    __getLineOfChar(index) {\r\n        if (index >= this.__textElement.getNumberOfChars()) return this.__stringsNum - 1;\r\n\r\n        let res = 0;\r\n        let sum = this.__stringsData[0];\r\n        while (sum <= index) {\r\n            sum += this.__stringsData[++res];\r\n        }\r\n        return res;\r\n    }\r\n\r\n    __lactCharIndex(line) {\r\n        let cur = 0;\r\n        let sum = this.__stringsData[cur];\r\n        while (cur < line) {\r\n            sum += this.__stringsData[++cur];\r\n        }\r\n        return sum - 1;\r\n    }\r\n\r\n    __firstCharIndex(line) {\r\n        let cur = 0;\r\n        let sum = 0;\r\n        while (cur < line) {\r\n            sum += this.__stringsData[cur++];\r\n        }\r\n        return sum;\r\n    }\r\n\r\n    __getWordBounds(index) {\r\n        let words = this.__value.split(' ');\r\n        let start = 0;\r\n        let end = words.shift().length;\r\n        while (end < index) {\r\n            start = end + 1;\r\n            end += words.shift().length + 1;\r\n        }\r\n        return {\r\n            start: start,\r\n            end: end\r\n        }\r\n    }\r\n\r\n    __getCharBBox(index) {\r\n        if (this.__value.length == 0) {\r\n            return {\r\n                x: this.__options.isCenterAligned ? this.__options.x + this.__options.width / 2 : this.__options.x,\r\n                y: this.__options.isVerticalCenterAligned ? this.__options.y + (this.__options.height - this.__lineHeight) / 2 : this.__options.y,\r\n                width: 0,\r\n                height: this.__lineHeight\r\n            }\r\n        }\r\n        if (this.__value.length <= index) {\r\n            let end = this.__textElement.getEndPositionOfChar(this.__value.length - 1);\r\n            let line = this.__getLineOfChar(index);\r\n            return {\r\n                x: end.x,\r\n                y: this.__textbb.y + this.__lineHeight * line,\r\n                width: 0,\r\n                height: this.__lineHeight\r\n            }\r\n        }\r\n        let start = this.__textElement.getStartPositionOfChar(index);\r\n        let end = this.__textElement.getEndPositionOfChar(index);\r\n        let line = this.__getLineOfChar(index);\r\n\r\n        return {\r\n            x: start.x,\r\n            y: this.__textbb.y + this.__lineHeight * line,\r\n            width: end.x - start.x,\r\n            height: this.__lineHeight\r\n        }\r\n    }\r\n\r\n    __appendSelblock(left, right) {\r\n        let dstr = 'M' + left.tx + ',' + left.ty\r\n            + ' L' + right.tx + ',' + right.ty\r\n            + ' ' + right.bx + ',' + right.by\r\n            + ' ' + left.bx + ',' + left.by;\r\n        let select = document.createElementNS(svgNS, 'path');\r\n        setAttributes.call(select, {\r\n            'fill': 'green',\r\n            'opacity': 0.5,\r\n            'class': 'js-texteditor-selblock',\r\n            'd': dstr\r\n        });\r\n        select.style['pointer-events'] = 'none';\r\n        this.__root.appendChild(select);\r\n    }\r\n\r\n    __setSelection(from, to) {\r\n        this.__deleteCursor();\r\n        this.__deleteSelBlock();\r\n\r\n        let curLine = this.__getLineOfChar(from);\r\n        let endLine = this.__getLineOfChar(to);\r\n\r\n        let fromChar = from;\r\n        let toChar;\r\n\r\n        let fromBBox = this.__getCharBBox(fromChar);\r\n        let l = {\r\n            tx: fromBBox.x,\r\n            ty: fromBBox.y,\r\n            bx: fromBBox.x,\r\n            by: fromBBox.y + fromBBox.height\r\n        }\r\n\r\n        while (curLine < endLine) {\r\n            toChar = this.__lactCharIndex(curLine);\r\n            let toBBox = this.__getCharBBox(toChar);\r\n            let r = {\r\n                tx: toBBox.x + toBBox.width,\r\n                ty: toBBox.y,\r\n                bx: toBBox.x + toBBox.width,\r\n                by: toBBox.y + toBBox.height\r\n            }\r\n            this.__appendSelblock(l, r);\r\n            fromChar = this.__firstCharIndex(++curLine);\r\n            let fromBBox = this.__getCharBBox(fromChar);\r\n            l = {\r\n                tx: fromBBox.x,\r\n                ty: fromBBox.y,\r\n                bx: fromBBox.x,\r\n                by: fromBBox.y + fromBBox.height\r\n            }\r\n        }\r\n\r\n        toChar = to;\r\n        let toBBox = this.__getCharBBox(toChar);\r\n        let r = {\r\n            tx: toBBox.x + toBBox.width,\r\n            ty: toBBox.y,\r\n            bx: toBBox.x + toBBox.width,\r\n            by: toBBox.y + toBBox.height\r\n        };\r\n        this.__appendSelblock(l, r);\r\n    }\r\n\r\n    __setCursor(index) {\r\n        this.__deleteSelBlock();\r\n        inputElement.selectionStart = inputElement.selectionEnd = index;\r\n        if (!this.__cursor) this.__appendCursorElement();\r\n        let charData = this.__getCharBBox(index);\r\n        setAttributes.call(this.__cursor, {\r\n            'x1': charData.x,\r\n            'y1': charData.y,\r\n            'x2': charData.x,\r\n            'y2': charData.y + charData.height\r\n        });\r\n        this.__cursor.style.display = 'inline';\r\n        if (!this.__blink) this.__blink = setInterval(() => {\r\n            this.__cursor.style.display = this.__cursor.style.display == 'none' ? 'inline' : 'none';\r\n        }, 500);\r\n    }\r\n\r\n    __screenToUser(mouseX, mouseY) {\r\n        let transform = this.__textElement.getScreenCTM().inverse();\r\n        let result = this.__textElement.ownerSVGElement.createSVGPoint();\r\n        result.x = transform.a * mouseX + transform.c * mouseY + transform.e;\r\n        result.y = transform.b * mouseX + transform.d * mouseY + transform.f;\r\n\r\n        return result;\r\n    }\r\n\r\n    __getIndexFromPos(mouseX, mouseY) {\r\n        let usrPos = this.__screenToUser(mouseX, mouseY);\r\n        let index = this.__textElement.getCharNumAtPosition(usrPos);\r\n        if (index == -1) return this.__value.length;\r\n\r\n        let charData = this.__getCharBBox(index);\r\n        index = usrPos.x < charData.x + charData.width / 2 ? index : index + 1;\r\n\r\n        return index;\r\n    }\r\n\r\n    __init() {\r\n        if (this.isInEditMode()) {\r\n            this.__textbb = this.__textElement.getBBox();\r\n            let tspans = this.__textElement.childNodes;\r\n            this.__stringsNum = tspans.length;\r\n            this.__stringsData = [];\r\n            this.__stringsData.lenght = this.__stringsNum;\r\n            for (let i = 0; i < this.__stringsNum; i++) {\r\n                this.__stringsData[i] = tspans[i].getNumberOfChars();\r\n            }\r\n        }\r\n    }\r\n\r\n    __testWidth(tspan, string) {\r\n        this.__setTextContent(tspan, string);\r\n        return tspan.getComputedTextLength() < this.__options.width;\r\n    }\r\n\r\n    __render() {\r\n        if (!document.body.contains(this.__textElement)) return;\r\n        $(this.__textElement).empty();\r\n        let options = this.__options;\r\n        let stringsNum = 0;\r\n        let words = this.__value.split(' ');\r\n        while (words.length) {\r\n            let tspan = document.createElementNS(svgNS, 'tspan');\r\n            this.__textElement.appendChild(tspan);\r\n\r\n            let test = '';\r\n            let localstr = words.shift();\r\n\r\n            if (!this.__testWidth(tspan, localstr)) {\r\n                let word = localstr.split('');\r\n                localstr = word.shift();\r\n                test = localstr + word[0];\r\n                while (this.__testWidth(tspan, test)) {\r\n                    localstr += word.shift();\r\n                    test = localstr + word[0];\r\n                }\r\n                words.unshift(word.join(''));\r\n            } else {\r\n                test = localstr + ' ' + words[0];\r\n                while (words.length && this.__testWidth(tspan, test)) {\r\n                    localstr += ' ' + words.shift();\r\n                    test = localstr + ' ' + words[0];\r\n                }\r\n                localstr += words.length ? ' ' : '';\r\n            }\r\n\r\n            this.__setTextContent(tspan, localstr);\r\n            setAttributes.call(tspan, {\r\n                'dy': this.__lineHeight,\r\n                'x': options.isCenterAligned ? options.x + options.width / 2 : options.x,\r\n                'class': this.__tspanClass\r\n            })\r\n            stringsNum++;\r\n        }\r\n        setAttributes.call(this.__textElement, {\r\n            'x': options.isCenterAligned ? options.x + options.width / 2 : options.x,\r\n            'y': options.isVerticalCenterAligned ? options.y + options.height / 2 - this.__lineHeight * stringsNum / 2 : options.y,\r\n            'text-anchor': options.isCenterAligned ? 'middle' : 'start'\r\n        })\r\n        this.__init();\r\n    }\r\n\r\n    __renderTimeout() {\r\n        if (!this.__rendering) {\r\n            this.__rendering = true;\r\n            let mod = this.__value !== inputElement.value;\r\n            this.__value = inputElement.value;\r\n            setTimeout(() => {\r\n                mod && this.__render();\r\n                this.__rendering = false;\r\n                if (this.__value !== inputElement.value) {\r\n                    this.__renderTimeout();\r\n                } else {\r\n                    if (inputElement.selectionStart === inputElement.selectionEnd) {\r\n                        this.__setCursor(inputElement.selectionEnd);\r\n                    }\r\n                    else\r\n                        this.__setSelection(inputElement.selectionStart, inputElement.selectionEnd - 1);\r\n                }\r\n            }, 0);\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        this.endEdit();\r\n        $(this.__textElement).remove();\r\n        this.__deleteCursor();\r\n        this.__deleteSelBlock();\r\n        delete this.__options;\r\n    }\r\n\r\n    __appendInputElement() {\r\n        if (!inputElement) {\r\n            let input = document.createElement('input');\r\n            input.type = 'text';\r\n            $(input).css({\r\n                position: 'absolute',\r\n                left: '-9999px',\r\n                top: '0'\r\n            });\r\n            document.body.appendChild(input);\r\n            inputElement = input;\r\n        }\r\n    }\r\n\r\n    __setInputSelection() {\r\n        let back = this.__lastSelectEnd < this.__lastSelectStart;\r\n        let from = this.__lastSelectStart;\r\n        let to = this.__lastSelectEnd;\r\n        if (back)\r\n            [from, to] = [to, from];\r\n        inputElement.selectionStart = from;\r\n        inputElement.selectionEnd = to;\r\n        inputElement.selectionDirection = back ? 'backward' : 'forward';\r\n    }\r\n\r\n    __appendTextElement() {\r\n        this.__textElement = document.createElementNS(svgNS, 'text');\r\n        setAttributes.call(this.__textElement, {\r\n            'fill': '#746e6e',\r\n            //'class': tspanClass\r\n        })\r\n        this.__textElement.style['white-space'] = 'pre';\r\n        this.__root.appendChild(this.__textElement);\r\n    }\r\n\r\n    __appendCursorElement() {\r\n        this.__cursor = document.createElementNS(svgNS, 'line');\r\n        setAttributes.call(this.__cursor, {\r\n            'stroke': '#333',\r\n            'stroke-width': 1\r\n        })\r\n        this.__root.appendChild(this.__cursor);\r\n    }\r\n\r\n    __deleteCursor() {\r\n        if (this.__blink) {\r\n            clearInterval(this.__blink);\r\n            this.__blink = false;\r\n        }\r\n        if (this.__cursor) {\r\n            $(this.__cursor).remove();\r\n            this.__cursor = false;\r\n        }\r\n    }\r\n\r\n    __setTextContent(el, str) {\r\n        $(el).empty();\r\n        $(el).append(str);\r\n    }\r\n\r\n    __deleteSelBlock() {\r\n        $('.js-texteditor-selblock', $(this.__root)).remove();\r\n    }\r\n\r\n    __keyup(event) {\r\n        event.stopPropagation();\r\n        if (event.keyCode == 13) {\r\n            this.endEdit();\r\n            return;\r\n        }\r\n        if (event.keyCode == 65 && event.ctrlKey == true) {\r\n            inputElement.selectionStart = 0;\r\n            inputElement.selectionEnd = inputElement.value.length;\r\n        }\r\n        this.__deleteSelBlock();\r\n        this.__renderTimeout();\r\n    }\r\n\r\n    __mouseClick(event) {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n\r\n        if (event.detail == 3) {\r\n            inputElement.selectionStart = 0;\r\n            inputElement.selectionEnd = inputElement.value.length;\r\n            this.__setSelection(0, this.__value.length);\r\n        }\r\n    }\r\n\r\n    __mouseDblclick(event) {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n        if (this.isInEditMode()) {\r\n            let index = this.__getIndexFromPos(event.pageX, event.pageY)\r\n            let selectWord = this.__getWordBounds(index);\r\n            this.__lastSelectStart = selectWord.start;\r\n            this.__lastSelectEnd = selectWord.end;\r\n            if (this.__lastSelectStart !== this.__lastSelectEnd) {\r\n                this.__setInputSelection();\r\n                let from = Math.min(this.__lastSelectStart, this.__lastSelectEnd);\r\n                let to = Math.max(this.__lastSelectStart, this.__lastSelectEnd) - 1;\r\n\r\n                this.__setSelection(from, to);\r\n            }\r\n        }\r\n    }\r\n\r\n    __mouseDown(event) {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n        this.__selecting = true;\r\n        if (this.isInEditMode()) {\r\n            this.__lastSelectStart = this.__lastSelectEnd = this.__getIndexFromPos(event.pageX, event.pageY);\r\n            this.__setCursor(this.__lastSelectStart);\r\n            $(document).one('mouseup', e => this.__mouseUp(e));\r\n            $(this.__textElement).bind('mousemove', e => this.__mouseMove(e));\r\n        }\r\n    }\r\n\r\n    __mouseMove(event) {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n        if (this.isInEditMode() && this.__selecting) {\r\n            this.__lastSelectEnd = this.__getIndexFromPos(event.pageX, event.pageY);\r\n            if (this.__lastSelectStart !== this.__lastSelectEnd) {\r\n                this.__setInputSelection();\r\n                let from = Math.min(this.__lastSelectStart, this.__lastSelectEnd);\r\n                let to = Math.max(this.__lastSelectStart, this.__lastSelectEnd) - 1;\r\n\r\n                this.__setSelection(from, to);\r\n            }\r\n        }\r\n    }\r\n\r\n    __mouseUp(event) {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n        inputElement.focus();\r\n        this.__selecting = false;\r\n        if (this.__lastSelectStart === this.__lastSelectEnd) {\r\n            this.__setCursor(this.__lastSelectStart);\r\n        } else {\r\n            this.__setInputSelection();\r\n        }\r\n        $(this.__textElement).unbind('mousemove');\r\n    }\r\n\r\n    static set InputElement(el) {\r\n        if (!(el instanceof HTMLInputElement)) throw 'element is not HTMLInputElement';\r\n        inputElement = el;\r\n    }\r\n\r\n    static get InputElement() {\r\n        return inputElement;\r\n    }\r\n\r\n    set textClass(c) {\r\n        this.__tspanClass = c;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./app/textEditor.js","import Editor from './textEditor'\r\n$(document).ready(() => {\r\n    let edit = new Editor($('#parent')[0], 'Edit me!', {\r\n        x: 100,\r\n        y: 10,\r\n        width: 250, \r\n        height: 250,\r\n        isCenterAligned: true,\r\n        isVerticalCenterAligned: true\r\n    });\r\n    function start(e) {\r\n        edit.startEdit(e).then((ret) => {\r\n            alert(ret);\r\n            $('#svg').one('click', start);\r\n        })\r\n    }\r\n    $('#svg').one('click', start);\r\n})\n\n\n// WEBPACK FOOTER //\n// ./app/index.js"],"sourceRoot":""}